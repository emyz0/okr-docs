/Users/emirhanyilmaz/Desktop/okr-docs/reranker_server.py:38: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
INFO:     Started server process [33346]
INFO:     Waiting for application startup.
INFO:__main__:ğŸ¤– Qwen3-Reranker-4B model yÃ¼kleniyor...
INFO:__main__:ğŸ“ Device: cpu
INFO:__main__:âœ… Tokenizer yÃ¼klendi (pad_token=<|endoftext|>, pad_token_id=151643)
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:08<00:08,  8.97s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:24<00:00, 12.87s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:24<00:00, 12.29s/it]
Some weights of Qwen3ForSequenceClassification were not initialized from the model checkpoint at Qwen/Qwen3-Reranker-4B and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
INFO:__main__:âœ… Model baÅŸarÄ±yla yÃ¼klendi
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     127.0.0.1:50716 - "GET /health HTTP/1.1" 200 OK
INFO:__main__:ğŸ”„ Reranking baÅŸladÄ±: sorgu='Tablo 1'e gÃ¶re 1921 Ä°stanbul Ä°ÅŸletme SayÄ±larÄ± nedi...', dokÃ¼=10
INFO:__main__:   âœ… Tokenize baÅŸarÄ±lÄ±: input shape=torch.Size([10, 256])
INFO:__main__:   ğŸš€ Model inference baÅŸladÄ±...
INFO:__main__:   âœ… Model inference baÅŸarÄ±lÄ±, logits shape=torch.Size([10, 2])
INFO:__main__:   ğŸ“Š Logits sample: [-2.3012776374816895, -1.7604845762252808]
INFO:__main__:   ğŸ“Š Probs sample: [0.36800312995910645, 0.6319968700408936]
INFO:__main__:   âœ… Scores hesaplandÄ±: [0.6319968700408936, 0.03385557606816292, 0.005979224573820829]...
INFO:__main__:âœ… Reranking tamamlandÄ±: top 10 seÃ§ildi
INFO:__main__:   En yÃ¼ksek skor: 0.6320
INFO:     127.0.0.1:51633 - "POST /rerank HTTP/1.1" 200 OK
INFO:__main__:ğŸ”„ Reranking baÅŸladÄ±: sorgu='Tablo 4'te verilen Vitaminlerin KaynaklarÄ± ve BazÄ±...', dokÃ¼=10
INFO:__main__:   âœ… Tokenize baÅŸarÄ±lÄ±: input shape=torch.Size([10, 256])
INFO:__main__:   ğŸš€ Model inference baÅŸladÄ±...
INFO:__main__:   âœ… Model inference baÅŸarÄ±lÄ±, logits shape=torch.Size([10, 2])
INFO:__main__:   ğŸ“Š Logits sample: [-2.89345121383667, -4.716592311859131]
INFO:__main__:   ğŸ“Š Probs sample: [0.8609426021575928, 0.13905739784240723]
INFO:__main__:   âœ… Scores hesaplandÄ±: [0.13905739784240723, 0.004347848705947399, 0.2920599579811096]...
INFO:__main__:âœ… Reranking tamamlandÄ±: top 10 seÃ§ildi
INFO:__main__:   En yÃ¼ksek skor: 0.5504
INFO:     127.0.0.1:51647 - "POST /rerank HTTP/1.1" 200 OK
INFO:__main__:ğŸ”„ Reranking baÅŸladÄ±: sorgu='karbonhidratlar hangi atomlardan meydana gelmiÅŸtir...', dokÃ¼=10
INFO:__main__:   âœ… Tokenize baÅŸarÄ±lÄ±: input shape=torch.Size([10, 256])
INFO:__main__:   ğŸš€ Model inference baÅŸladÄ±...
INFO:__main__:   âœ… Model inference baÅŸarÄ±lÄ±, logits shape=torch.Size([10, 2])
INFO:__main__:   ğŸ“Š Logits sample: [2.192643880844116, -2.8041560649871826]
INFO:__main__:   ğŸ“Š Probs sample: [0.9932858347892761, 0.006714158691465855]
INFO:__main__:   âœ… Scores hesaplandÄ±: [0.006714158691465855, 0.0003209215064998716, 0.056221216917037964]...
INFO:__main__:âœ… Reranking tamamlandÄ±: top 10 seÃ§ildi
INFO:__main__:   En yÃ¼ksek skor: 0.8267
INFO:     127.0.0.1:51773 - "POST /rerank HTTP/1.1" 200 OK
INFO:__main__:ğŸ”„ Reranking baÅŸladÄ±: sorgu='Tablo 4'te verilen Vitaminlerin KaynaklarÄ± ve BazÄ±...', dokÃ¼=10
INFO:__main__:   âœ… Tokenize baÅŸarÄ±lÄ±: input shape=torch.Size([10, 256])
INFO:__main__:   ğŸš€ Model inference baÅŸladÄ±...
INFO:__main__:   âœ… Model inference baÅŸarÄ±lÄ±, logits shape=torch.Size([10, 2])
INFO:__main__:   ğŸ“Š Logits sample: [-2.89345121383667, -4.716592311859131]
INFO:__main__:   ğŸ“Š Probs sample: [0.8609426021575928, 0.13905739784240723]
INFO:__main__:   âœ… Scores hesaplandÄ±: [0.13905739784240723, 0.004347848705947399, 0.2920599579811096]...
INFO:__main__:âœ… Reranking tamamlandÄ±: top 10 seÃ§ildi
INFO:__main__:   En yÃ¼ksek skor: 0.5504
INFO:     127.0.0.1:52084 - "POST /rerank HTTP/1.1" 200 OK
